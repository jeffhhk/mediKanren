#lang racket
(require "query.rkt")


;; chemical->drug-filter functions take a chemical list and
;; return a list of chemicals that have drug-safe predicates (i.e, drugs)
;; In this function, I use a 2-hop query to get from CHEBI:  to a DRUGBANK:
;; so that I can assess if a particular chemical has any drug-safe predicates

(define (chemical->drug-filter chemical-list)
  (filter 
   (lambda (chemical) 
     (define q
       (query/graph
        ((C chemical)
         (D #f)
         (Disease #f))
        ((C->D '("same_as"))
         (D->Disease drug-safe))
        (C C->D D)
        (D D->Disease Disease)))
     (empty? (curies/query q 'D)))
   chemical-list))

;; examples:
(define strategy1_chemicals
  '("CHEBI:28119"
  "CHEBI:16469"
  "CHEBI:37537"
  "CHEBI:41879"
  "CHEBI:17026"
  "CHEBI:6541"
  "CHEBI:4903"
  "CHEBI:33216"
  "CHEBI:9168"
  "CHEBI:41774"
  "CHEBI:65329"
  "CHEBI:17347"
  "CHEMBL:CHEMBL460433"
  "CHEBI:17747"
  "CHEBI:49662"
  "CHEBI:22984"
  "CHEBI:4031"
  "CHEBI:27584"
  "CHEBI:16243"
  "CHEBI:9130"
  "CHEBI:78543"
  "CHEBI:15365"
  "CHEMBL:CHEMBL62381"
  "CHEBI:52717"
  "CHEBI:175901"
  "CHEBI:16113"
  "CHEBI:29865"
  "CHEBI:28748"
  "CHEBI:5132"
  "CHEBI:44423"
  "CHEBI:45713"
  "CHEBI:15738"
  "CHEBI:16356"
  "CHEBI:77986"
  "CHEBI:3766"
  "CHEBI:17489"
  "CHEBI:8899"
  "CHEBI:15355"
  "CHEBI:3962"
  "CHEBI:28088"
  "CHEBI:76004"
  "CHEBI:27656"
  "CHEBI:77006"
  "CHEMBL:CHEMBL504"
  "CHEBI:8863"
  "CHEBI:9150"
  "CHEBI:31401"
  "CHEBI:16330"
  "CHEBI:44296"
  "CHEBI:15930"
  "CHEBI:17609"
  "CHEBI:92413"
  "CHEBI:47808"
  "CHEMBL.COMPOUND:CHEMBL3545133"
  "CHEMBL.COMPOUND:CHEMBL2109588"
  "CHEBI:517248"
  "CHEBI:28364"
  "CHEBI:9786"
  "CHEBI:3237"
  "CHEMBL:CHEMBL1372588"
  "CHEBI:135742"
  "CHEBI:9241"
  "CHEBI:6920"
  "CHEMBL:CHEMBL305576"
  "CHEBI:17712"
  "CHEBI:5759"
  "CHEBI:34892"
  "CHEBI:15960"
  "CHEBI:49040"
  "GTPI:5965"
  "CHEBI:8198"
  "CHEBI:34935"
  "CHEBI:52289"
  "CHEBI:49668"
  "CHEBI:34888"
  "CHEBI:135736"
  "CHEBI:138000"
  "CHEBI:28940"
  "CHEBI:29678"
  "CHEBI:2666"
  "CHEBI:35053"
  "CHEMBL.COMPOUND:CHEMBL3707348"
  "CHEBI:3763"
  "CHEBI:50114"
  "CHEMBL.COMPOUND:CHEMBL3545396"
  "CHEBI:16412"
  "CHEBI:88522"
  "CHEBI:50694"
  "CHEMBL:CHEMBL1903674"
  "CHEBI:78373"
  "CHEBI:28694"
  "CHEBI:17578"
  "CHEBI:30768"
  "CHEBI:76612"
  "CHEBI:338412"
  "CHEBI:17823"
  "CHEMBL:CHEMBL1371200"
  "CHEBI:30740"
  "CHEBI:107643"
  "CHEBI:27385"
  "CHEBI:15756"
  "CHEBI:135949"
  "CHEBI:15367"
  "CHEBI:63954"
  "GTPI:8492"
  "CHEBI:137113"
  "CHEBI:47495"
  "CHEBI:28499"
  "CHEBI:135735"
  "CHEBI:566274"
  "CHEBI:28112"
  "CHEBI:76003"
  "CHEBI:3655"
  "CHEMBL:CHEMBL1221984"
  "CHEMBL.COMPOUND:CHEMBL545315"
  "CHEBI:49960"
  "CHEMBL:CHEMBL1644699"
  "CHEBI:28842"
  "CHEBI:65310"
  "CHEBI:8081"
  "CHEMBL:CHEMBL8823"
  "CHEMBL:CHEMBL1565107"
  "CHEBI:30563"
  "CHEBI:91452"
  "CHEBI:4659"
  "CHEBI:8062"
  "CHEBI:16698"
  "CHEBI:18388"
  "CHEBI:28790"
  "CHEMBL.COMPOUND:CHEMBL2105719"
  "CHEBI:92843"
  "CHEBI:18243"
  "CHEBI:51450"
  "CHEBI:90695"
  "CHEBI:7590"
  "CHEMBL.COMPOUND:CHEMBL499968"
  "CHEBI:40303"
  "CHEMBL.COMPOUND:CHEMBL3137331"
  "CHEMBL.COMPOUND:CHEMBL356359"
  "CHEBI:62825"
  "CHEBI:2611"
  "CHEBI:15553"
  "CHEBI:132853"
  "CHEBI:351346"
  "CHEBI:17234"
  "CHEBI:6402"
  "CHEBI:39462"
  "CHEBI:7465"
  "CHEBI:34662"
  "CHEMBL:CHEMBL2146125"
  "CHEBI:31746"
  "CHEBI:8382"
  "CHEBI:18291"
  "CHEBI:18152"
  "CHEBI:95341"
  "CHEBI:35456"
  "CHEBI:18185"
  "CHEBI:3385"
  "CHEBI:6801"
  "CHEBI:34076"
  "CHEBI:6715"
  "CHEBI:7735"
  "CHEBI:45307"
  "CHEBI:46024"
  "CHEMBL:CHEMBL1981220"
  "CHEBI:66917"
  "CHEBI:556075"
  "CHEBI:27363"
  "CHEBI:15368"
  "CHEBI:83732"
  "CHEMBL.COMPOUND:CHEMBL1645462"
  "CHEBI:4305"
  "CHEBI:48045"
  "CHEMBL:CHEMBL190083"
  "CHEBI:65347"
  "CHEBI:15343"
  "CHEBI:86194"
  "CHEBI:15940"
  "CHEBI:38927"
  "CHEBI:31561"
  "CHEBI:6958"
  "CHEBI:90939"
  "CHEBI:32061"
  "CHEBI:6842"
  "CHEBI:6413"
  "CHEMBL:CHEMBL7463"
  "CHEBI:76607"
  "CHEMBL.COMPOUND:CHEMBL2103884"
  "CHEBI:35696"
  "CHEMBL.COMPOUND:CHEMBL1709719"
  "CHEBI:90948"
  "CHEBI:4046"
  "CHEBI:24814"
  "CHEMBL.COMPOUND:CHEMBL587723"
  "CHEBI:3084"
  "CHEBI:34269"
  "CHEBI:75253"
  "CHEBI:61400"
  "CHEBI:86345"
  "CHEBI:34873"
  "CHEBI:132268"
  "GTPI:8145"
  "CHEBI:43616"
  "CHEBI:135590"
  "CHEBI:15891"
  "CHEMBL:CHEMBL1977579"
  "CHEBI:50859"
  "CHEBI:9635"
  "CHEBI:101278"
  "CHEBI:45652"
  "CHEBI:3752"
  "CHEBI:3175"
  "CHEBI:44445"
  "CHEBI:28680"
  "CHEBI:39548"
  "CHEMBL.COMPOUND:CHEMBL3545154"
  "CHEBI:9908"
  "CHEBI:92890"
  "CHEBI:18145"
  "CHEBI:134301"
  "CHEMBL:CHEMBL499968"
  "CHEBI:69581"
  "CHEBI:39867"
  "CHEBI:17997"
  "CHEBI:17833"
  "CHEBI:15843"
  "CHEBI:45863"
  "CHEBI:16118"
  "CHEBI:61399"
  "CHEBI:27638"
  "CHEBI:28527"
  "CHEBI:7565"
  "CHEBI:61390"
  "CHEBI:61057"
  "CHEMBL:CHEMBL1201288"
  "CHEBI:2814"
  "CHEBI:91370"
  "CHEBI:32020"
  "CHEBI:8633"
  "CHEMBL:CHEMBL378104"
  "CHEBI:4460"
  "CHEBI:67272"
  "CHEBI:3440"
  "CHEBI:17241"
  "CHEBI:4042"
  "CHEBI:23359"))
                                          
(chemical->drug-filter strategy1_chemicals)
